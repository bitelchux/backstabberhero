<head><meta name="monetization" content="$coil.xrptipbot.com/FpG5bRAeSVuJbdCJddtAgw"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0"><link rel="manifest" href="pwa.webmanifest"></head><body class="desktop"><div id="c"><div class="left-controls lan"><div id="l">&larr;</div><div id="r">&rarr;</div></div><canvas height="240px" width="256px"></canvas><div class="right-controls"><div class="arrows por"><div id="l2">&larr;</div><div id="r2">&rarr;</div></div><div class="buttons"><div id="j">Jump</div><div id="s">Stab</div><div id="d">Duck</div></div></div></div><style>body{user-select:none;margin:0;overflow:hidden;background:#000}body.mobile{color:#fff}#c{height:100vh}body.por .left-controls{display:none}body:not(.por) .arrows{display:none}body div{display:flex;flex:1}body.por > div{flex-direction:column}canvas{background-color:#aaa}body.por canvas{height:100vw}body:not(.por) canvas{margin:auto;height:100vh}.right-controls{display:flex;flex-shrink:1}.left-controls div,.right-controls > div > div{align-items:center;justify-content:center}.arrows div{flex-grow:1;max-width:100px}.buttons{flex-direction:column}.buttons div{width:100%;min-width:50%;margin-left:auto}canvas{image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated}</style><script src="gsw.js"></script><script type="text/javascript">!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);let n,s;function o(){return n}function a(){return s}function r(){return n=document.querySelector("canvas"),(s=n.getContext("2d")).imageSmoothingEnabled=!1,{canvas:n,context:s}}class h{constructor({spriteSheet:t,frames:e,frameRate:i,loop:n=!0,flipped:s}={}){this.flipped=s,this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=n;let{width:o,height:a,margin:r=0}=t.frame;this.width=o,this.height=a,this.margin=r,this._f=0,this._a=0}clone(){return l(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,height:i=this.height,context:n=a()}={}){let s=this.frames[this._f]/this.spriteSheet._f|0,o=this.frames[this._f]%this.spriteSheet._f|0;this.flipped&&(n.scale(-1,1),t-=16),n.drawImage(this.spriteSheet.image,16*o,s*i,16,i,Math.round(t),Math.round(e),16,i)}}function l(t){return new h(t)}l.prototype=h.prototype,l.class=h;new WeakMap;const c=()=>{};function f(){let t=o();a().clearRect(0,0,t.width,t.height)}function d({fps:t=60,clearCanvas:e=!0,update:i,render:n}={}){let s,o,a,r,h,l=0,d=1e3/t,g=1/t,u=e?f:c;function p(){if(o=requestAnimationFrame(p),a=performance.now(),r=a-s,s=a,!(r>1e3)){for(l+=r;l>=d;)h.update(g),l-=d;u(),h.render()}}return h={update:i,render:n,isStopped:!0,start(){s=performance.now(),this.isStopped=!1,requestAnimationFrame(p)},stop(){this.isStopped=!0,cancelAnimationFrame(o)}}}class g{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive))throw Error("Must provide create() function which returns an object with init(), update(), and isAlive() functions");this._c=t,this._i=0,this.objects=[t()],this.size=1,this.maxSize=e}get(t={}){if(this.objects.length==this._i){if(this.size===this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.unshift(this._c());this.size=this.objects.length}let e=this.objects.shift();return e.init(t),this.objects.push(e),this._i++,e}getAliveObjects(){return this.objects.slice(this.objects.length-this._i)}clear(){this._i=this.objects.length=0,this.size=1,this.objects.push(this._c())}update(t){let e,i=this.size-1,n=Math.max(this.objects.length-this._i,0);for(;i>=n;)(e=this.objects[i]).update(t),e.isAlive()?i--:(this.objects=this.objects.splice(i,1).concat(this.objects),this._i--,n++)}render(){let t=Math.max(this.objects.length-this._i,0);for(let e=this.size-1;e>=t;e--)this.objects[e].render()}}function u(t){return new g(t)}function p(t,e){let i=[],n=e.x+e.width/2,s=e.y+e.height/2,o=t.y<s&&t.y+t.height>=e.y,a=t.y+t.height>=s&&t.y<e.y+e.height;return t.x<n&&t.x+t.width>=e.x&&(o&&i.push(0),a&&i.push(2)),t.x+t.width>=n&&t.x<e.x+e.width&&(o&&i.push(1),a&&i.push(3)),i}u.prototype=g.prototype,u.class=g;class m{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;let n=o();this.bounds=i||{x:0,y:0,width:n.width,height:n.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map(function(t){t.clear()}),this._b=!1,this._o.length=0}get(t){let e,i,n=new Set;for(;this._s.length&&this._b;){for(e=p(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].get(t).forEach(t=>n.add(t));return Array.from(n)}return this._o.filter(e=>e!==t)}add(){let t,e,i,n;for(e=0;e<arguments.length;e++)if(i=arguments[e],Array.isArray(i))this.add.apply(this,i);else if(this._b)this._a(i);else if(this._o.push(i),this._o.length>this.maxObjects&&this._d<this.maxDepth){for(this._sp(),t=0;n=this._o[t];t++)this._a(n);this._o.length=0}}_a(t,e,i){for(e=p(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].add(t)}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,i=0;i<4;i++)this._s[i]=y({bounds:{x:this.bounds.x+(i%2==1?t:0),y:this.bounds.y+(i>=2?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1,this._s[i]._p=this}}function y(t){return new m(t)}y.prototype=m.prototype,y.class=m;class A{constructor(t,e){this._x=t||0,this._y=e||0}add(t,e){return console.log(t,e),b(this.x+(t.x||0)*(e||1),this.y+(t.y||0)*(e||1))}clamp(t,e,i,n){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}function b(t,e){return new A(t,e)}b.prototype=A.prototype,b.class=A;class x{constructor(t){this.init(t)}init(t={}){let{x:e,y:i,dx:n,dy:s,image:o}=t;this.position=b(e,i),this.velocity=b(n,s),this.height=16,this.context=a();for(let e in t)this[e]=t[e];o&&(this.width=void 0!==width?width:o.width,this.height=void 0!==height?height:o.height)}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get animations(){return this._a}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=16,this.height=this.height||i.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){this.position={x:this.x+this.dx,y:this.y+this.dy},this.currentAnimation&&this.currentAnimation.update(t)}render(){this.context.save(),this.context.translate(this.x,this.y),this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.context.restore()}}function S(t){return new x(t)}S.prototype=x.prototype,S.class=x;class E{constructor({image:t,frameHeight:e,animations:i}={}){this.animations={},this.image=t,this.frame={width:16,height:e},this._f=99,this.createAnimations(i)}createAnimations(t){let e,i;for(i in t){let{frames:n,frameRate:s,loop:o,flipped:a}=t[i];e=[],e=+n==n?[n]:n,this.animations[i]=l({flipped:a,spriteSheet:this,frames:e,frameRate:s,loop:o})}}}function w(t){return new E(t)}w.prototype=E.prototype,w.class=E;var T;!function(t){t[t.Jump=0]="Jump",t[t.Up=1]="Up",t[t.Left=2]="Left",t[t.Right=3]="Right",t[t.Duck=4]="Duck",t[t.Stab=5]="Stab",t[t.Action=6]="Action",t[t.Any=7]="Any",t[t.Space=8]="Space"}(T||(T={}));let k={},O={},M=[];function I(t){let e=O[t.which];e&&(k[e]=!0),k[T.Jump]=e==T.Up||e==T.Space,k[T.Action]=e==T.Stab||e==T.Space,k[T.Any]=!0}function R(t){let e=O[t.which];e&&(k[e]=!1),k[T.Jump]=!1,k[T.Action]=!1,k[T.Any]=!1,k[T.Any]=!!Object.keys(k).find(t=>k[t])}function C(){k={}}function _(t){return!!k[t]}function j(){return M}const B=(t,e,i,n=1,s=.1,o=0,a=0,r=0,h=0)=>{let l=44100,c=Math.PI;i*=2*c/l,i*=1+e*(2*Math.random()-1),o*=1e3*c/l**2,s*=0|(n=0<n?l*(10<n?10:n)|0:1),r*=2*c/l,h*=c,e=[];for(var f=0,d=0,g=0;g<n;++g)e[g]=.5*t*Math.cos(f*i*Math.cos(d*r+h))*(g<s?g/s:1-(g-s)/(n-s)),f+=1+a*(2*Math.random()-1),d+=1+a*(2*Math.random()-1),i+=o;return t=zzfx_x.createBuffer(1,n,l),i=zzfx_x.createBufferSource(),t.getChannelData(0).set(e),i.buffer=t,i.connect(zzfx_x.destination),i.start(),i},L=t=>Math.abs(Math.ceil(t))%2==0;var v=(t,e,i,n,s=1,o=0,r=0,h=a())=>{e=""+e;i=(i=-1===i?-128:i)<0?Math.abs(i)-8*e.length*s/2:i;let l=0;for(let a=0;a<e.length;a++){let c=e.charCodeAt(a)-65;if(-33!=c){if(-55===c){n+=10*s,c=-36,l=8*-(a+1)*s;continue}c<0&&(c+=46),h.drawImage(t,8*c,0,8,8,i+8*a*s+l,n+o*Math.sin(r/9+a/3),8*s,8*s)}}};const J=t=>{const e=document.getElementsByTagName("body")[0],i=window.nkholski||{},n=a();window.nkholski=Object.assign({body:e},i,t,{context:n,mobile:"ontouchstart"in window})},P=()=>window.nkholski,U=t=>{const e=document.createElement("canvas");e.width=256,e.height=P().context.canvas.height;const i=e.getContext("2d");return i.imageSmoothingEnabled=!1,t(i),e},F=atob("J/N3VyGFUcZb4SQ4JiAn8ylYIUNsyFmGTCAn8yVsgKCBMiHPba5ZTCXTjiAl8yVsqHIhM22uMOFURyogJfM+W3KfqHIhiUVsJa0qdVIggF4kss5MJGEhP6KOMu5MqChIVCDAWEuNcpIkS1lAIS3X3jSUKq6UqVRrKCAl82drJUQocSGBOLgk43QzJV6sICbzJIOZhnJIIdVh0DFQrF0lICfgJvNnjSEy4oAkOVRrTCAkkoyPmYgkjCFpbpkwOlTalN9UM3QggDA+WyTzjYMhL1+jMJZsICTzJdU/3iXaIT+IK0BlTE9M1U7xlOslILNtKvMh3FC4J96UwSWdbJCMQiUgJ/NB3yHppmUxoFTOJsEmtCanJpomjSZzJoAmZiZZJkwmPypFJFIkXyRsJHkkhiSTJK0kuiTHJNQk4SQgs20q8yHcULgn3pSdbJCMQiUgJMraRMBXpkJYXiVAZVghMTjeQM10ILM2ckfAMSGAnZ4xtyTJJCCMfLRkJHiMdsRDJIE+VFk7mjshLDTeaCZMt0xSTLwmzCggJGgl84CZjJAkUSE7yTWA7PQqJaFQXlDFzO8l"),D=(t,e=13)=>{const i=(t-=35)%e;return[i,(t-i)/e]},H=(t,e)=>U(i=>{const{mobile:n,gfx:s}=P(),o=(t=>(t*=100,(e,i=0)=>{const n=1e4*Math.sin(t++);return Math.round(i+(n-Math.floor(n))*(e-i))}))(t),a=t%2;if(i.beginPath(),i.fillStyle=a?"#036":"#39F",i.fillRect(0,0,256,240),a){i.fillStyle="#FFF";for(let t=0;t<10+o(5);t++){const t=o(2,1);i.fillRect(o(256),o(120),t,t)}}else i.fillStyle="#FF0";const[r,h,l]=[o(16,6),9+o(245),4+o(20)];for(let t=3;--t;)i.globalAlpha=2/(3*t),i.arc(h,l+t,r*t,0,2*Math.PI,!1),i.lineWidth=0,i.fill(),i.beginPath();i.globalAlpha=1;for(let t=1;t>0;t--){let t=0;for(;t<256;){i.fillStyle=a?"#345":"#777";let e=36+Math.round(16*o(2)),n=o(100,48);i.fillRect(t,n,e,500),i.stroke(),i.globalAlpha=.2;for(let s=0;s<e-8;s+=8)for(let e=6;e<500;e+=16)i.fillStyle=o(2)?"#000":o(3)?"#fff":"#ff0",i.fillRect(t+s+2,n+e,6,8);i.stroke(),i.globalAlpha=1,t=Math.floor(t+e+o(3))}}e.platforms.forEach(t=>{for(let e=0;e<t.h;e+=16)for(let n=0;n<t.w;n+=16){const o=-16*(0===e?1:0);i.drawImage(s,128,16+o,16,16,t.x+n,t.y+e,16,16)}})}),N={top:!1,right:!1,bottom:!1,left:!1},V=(t,e)=>{let i=null;return e.forEach(e=>{e.dead||t.x<e.x+e.width&&t.x+16>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y&&(i=e)}),i},W=(t,e,i=null)=>{t.blocked=Object.assign({},N,{left:t.x<0,right:t.x>240}),t.x=t.blocked.left?0:t.x;let n=!1;i&&(n=!0);let s=i?t.height-i:0,o=t.y+s;i=i||t.height;const a=t.blocked;return e.forEach((e,n)=>{const r={};if(r.left=e.x+e.w-t.x,r.right=16+t.x-e.x,r.top=e.y+e.h-o,r.bottom=i+o-e.y,r.top>=0&&r.right>=0&&r.bottom>=0&&r.left>=0){let e=99,i="";["left","right","top","bottom"].forEach(t=>{r[t]<e&&(e=r[t],i=t)}),a[i]=!0,a.any=!0,t.y=a.top||a.bottom?16*Math.round(t.y/16)+(a.top?s:0):t.y,t.x=a.left||a.right?16*Math.round(t.x/16):t.x,t.dx=a.left||a.right?0:t.dx,t.dy=a.top||a.bottom?0:t.dy}}),a};var K,Y,G,z;!function(t){t[t.Left=-1]="Left",t[t.None=0]="None",t[t.Right=1]="Right"}(K||(K={})),function(t){t[t.Walker=0]="Walker",t[t.Stands=1]="Stands",t[t.Sleeper=2]="Sleeper"}(Y||(Y={})),function(t){t[t.Walk=0]="Walk",t[t.AboutToTurn=1]="AboutToTurn",t[t.Turn=2]="Turn",t[t.Watch=3]="Watch"}(G||(G={})),function(t){t[t.WalkTime=200]="WalkTime",t[t.TurnTime=50]="TurnTime"}(z||(z={}));const Q=(t,{turnState:e,player:i,level:n,gameOver:s,tick:o})=>{const a=!((t,e)=>{const i=Object.assign({},t,{x:t.x+(1===t.facing?8:-8),y:t.y+8});return W(i,e),i.blocked})(t,n.platforms).bottom;let r="Idle";if(t.dy+=.2,!t.dead&&!t.gotPlayer){if(!(t.sleepTimer>0))return e=t.turns?e:G.Walk,t.dx=0,((t,e,i)=>{if(e.barrel&&0===e.dx&&0===e.dy)return!1;let n=!1;return[1,16].forEach(s=>{let o,a=0;for(;a+=8;){const e=t.x+8+a*t.facing;if(o=e,W({x:e,y:t.y+s,height:14},i).any||e<0||e>232)break}n=n||!!V(e,[{x:t.x+8+(-1===t.facing?-a:0),y:t.y+s,height:14,width:a}])}),n})(t,i,n.platforms)?(t.gotPlayer=!0,i.facing=-t.facing,B(1,0,100,.7,.42,1.5,.6,.7,.2),t.gotPlayer=!0):t.gotPlayer||(e===G.Turn&&(t.facing=-t.facing),t.walks&&e===G.Walk&&(t.dx=t.facing*t.speed,(t.blocked.left&&t.dx<0||t.blocked.right&&t.dx>0||t.blocked.bottom&&a)&&(t.facing=-t.facing)),t.sleeper&&0===t.sleepTimer&&(t.facing=L(o/20)?1:-1),r=t.walks&&e===G.Walk?"Walk":"Idle"),t.playAnimation("enemy"+r+(-1==t.facing?"Left":"Right")),s;t.playAnimation("sleepRight")}},X=t=>{const e=(t=>{const e=F.split(" ")[t],[i,n]=e.split("!"),s={platforms:[],enemies:[],items:[]};for(let t=i.length-1;t>0;t-=2){let[e,n]=D(i.charCodeAt(t)),[o,a]=D(i.charCodeAt(t-1));e=15-o-e,s.platforms.push({x:16*a,y:16*e,w:16*n,h:16*o})}for(let t=3;t>0;t-=4){let[e,i]=D(n.charCodeAt(t-3)),[o,a]=D(n.charCodeAt(t-2)),[r,h]=D(n.charCodeAt(t-1)),[l,c]=D(n.charCodeAt(t));s.stars=[{x:a,y:o,t:l+1},{x:h,y:r,t:c+1}],s.player={x:16*i,y:16*e}}for(let t=n.length-1;t>3;t-=2){let[e,i]=D(n.charCodeAt(t-1));e++;let o=n.charCodeAt(t)-35;const a={};["isEnemy","facing","turns","walks","sleeper"].forEach(t=>{a[t]=!!(o%2),o=Math.floor(o/2)}),a.isEnemy?s.enemies.push(Object.assign({},a,{x:16*i,y:16*e,color:1+a.turns+(2*a.sleeper||4*a.walks),facing:a.facing?-1:1,data:o})):s.items.push({type:"berrel",x:i,y:e})}return s})(t),{spriteSheets:i,assets:n,context:s,font:o}=P();let a,r,h,l,c,f,g,u,p,m=100,y=0,A=[],b=0,x=1,E=!1;l=!1,c=!1,a=S({x:e.player.x,y:e.player.y,width:16,height:32,blocked:Object.assign({},N),standing:!0,facing:e.player.x>120?K.Left:K.Right,stabTimer:-1,gameOver:-1,animations:i[0].animations,barrel:null}),r=S({width:16,height:32,animations:i[0].animations}),u=[],e.stars.forEach(t=>{const e=S({x:16*t.x,y:16*t.y,height:16,sleepTimer:5e3*t.t,animations:i[0].animations});u.push(e),e.playAnimation("starLeft")}),h=((t,e)=>{const i=[];return t.forEach(t=>{i.push(S(Object.assign({},t,{width:16,height:32,blocked:Object.assign({},N),speed:t.walks?(1+t.data)/4:0,animations:e[t.color].animations,sleepTimer:t.sleeper?t.walks?0:1e4*t.data:0})))}),i})(e.enemies,i),e.items.forEach(t=>{const e=S({x:16*t.x,y:16*t.y,height:32,animations:i[0].animations});A.push(e),e.playAnimation("barrelLeft")});const w=t=>{const e=Math.ceil(t.sleepTimer/1e3-p);e<1&&(t.sleepTimer=0),t.sleepTimer>0&&!t.dead&&v(o,""+e,-(t.x+8),t.y-9,1)},k=t=>{let e=a.barrel;A.push(e),e.x=a.x,e.y=a.y,e.dx=a.facing*t,e.dy=-2,a.barrel=null},O=H(t,e);let M;const I=d({update:function(){M=m<290?G.Walk:m<310?G.AboutToTurn:310===m||330===m?G.Turn:G.Watch;const i={level:e,player:a,enemies:h,gameOver:c,tick:b,turnState:M},n=c;m+=330===m?-m:1,p=++b/60,g=L(b/20),a.stabTimer--,a.dy+=.2,a.dx=0;let s=l?"idle":"duck";if(a.y>400&&(c=!0),c){if(_(T.Action)&&E&&1===x)return x=2,I.stop(),void it(l?t:-1,y+1)}else a.standing||(a.standing=!0,a.y-=16,a.height=32),s="idle",_(T.Left)&&(a.dx=-1,a.facing=K.Left,s="walk"),_(T.Right)&&(a.dx=1,a.facing=K.Right,s="walk"),f=f||!_(T.Jump),a.blocked.bottom&&(a.dy>0&&(a.dy=0),_(T.Duck)&&!a.barrel?(s="duck",a.standing=!1,a.y+=16,a.height=16,a.dx=0):_(T.Jump)&&f&&(B(1,0,200,.4,0,2,0,0,5),a.dy=-4.5,f=!1)),_(T.Stab)&&a.stabTimer<-7&&a.standing&&(B(1,.1,800,.1,.66,1.1,3.1,.1,.85),a.stabTimer=9,a.barrel&&k(1)),a.dy<0&&a.blocked.top&&(a.dy=0),a.blocked.bottom||(s=a.dy>0?"jumpDown":"jumpUp");if(r.visible=!1,a.stabTimer>0){s="stab",r.visible=!0,r.playAnimation("knife"+(-1===a.facing?"Left":"Right"));const t=V({height:16,x:a.x+16*a.facing,y:a.y},h);t&&(B(1,0,100,.4,0,.9,7,15,0),t.dead=!0,t.dx=1.5*a.facing,t.dy=-2,t.playAnimation("dead"+(1===a.facing?"Left":"Right")))}a.barrel&&(s="barrel"+("walk"===s?"Player":"")),a.playAnimation(s+(a.facing===K.Left?"Left":"Right")),a.advance(),W(a,e.platforms,24),r.x=a.x+16*a.facing,r.y=a.y,u.forEach((t,e)=>{V(a,[t])&&(B(1,0,400,.5,.5,0,0,5,0),y++,u.splice(e,1))}),A.forEach((t,e)=>{!t.dx&&V(a,[t])&&(a.barrel=t,A.splice(e,1)),t.dx&&(t.dy+=.1,t.advance())});const o=V(a,h);o&&!a.barrel&&(o.facing=o.x<a.x?K.Right:K.Left),l=!0,h.forEach(t=>{Q(t,i),t.advance(),t.dead||(l=!1,W(t,e.platforms),t.gotPlayer&&(c||(a.standing&&(a.y+=16,a.height=16),c=!0)))}),l&&(c=!0),c&&!n&&(a.barrel&&k(-1),setTimeout(()=>{E=!0},1e3))},render:function(){s.drawImage(O,0,0),r.visible&&r.render(),a.render(),u.forEach((t,e)=>{w(t),t.render(),0==t.sleepTimer&&(B(1,0,-250,.7,.7,1.4,0,5,1.49),u.splice(e,1))}),h.forEach(t=>{t.gotPlayer&&v(o,"HEY/",-(t.x+8),t.y-9,1,2,2*b),w(t),t.turns&&M===G.AboutToTurn&&L(b)||t.render()}),A.forEach(t=>{t.render()}),c&&(u=[],l?v(o,["OK","GOOD","GREAT"][y]+" STABBING",-1,50,2):v(o,"STAB OVER",56,50,2),g&&E&&v(o," PRESS Z",92,70,1))}});I.start()},Z=t=>{const e=[];for(let i=0;i<3;i++)e[i]=11*parseInt(t.substr(i,1),16);return e},q=["fec","fea","ec9","fc8","b63","a86","731","210"],$=[["jumpUp",2],["jumpDown",0],["walk",[1,0,2,0],4],["idle",0],["duck",5],["stab",3],["knife",4],["dead",11],["enemyIdle",12],["enemyWalk",[12,13],3],["star",6],["barrelPlayer",[14,15],3],["barrel",7],["sleep",[9,10],3]];var tt=(t,e)=>((t,e)=>{let i=[],n={};$.forEach(t=>{n[t[0]+"Right"]={frames:t[1],frameRate:t[2],loop:t[3]},n[t[0]+"Left"]=Object.assign({},n[t[0]+"Right"],{flipped:!0})});let s=!1;return["9CF","F9F","0C0","60C","396","630","0CF"].forEach((o,a)=>{let r;r=a>0?Z(o):e;const h=document.createElement("canvas"),l=h.getContext("2d"),c=t;h.width=260,h.height=64,l.drawImage(c,0,0),l.drawImage(c,0,26,16,6,224,26,16,6),l.drawImage(c,112,5,16,27,224,0,16,27),l.drawImage(c,32,26,16,6,240,26,16,6),l.drawImage(c,112,5,16,27,240,1,16,27);var f=l.getImageData(0,0,260,64);const d=Math.round(7*Math.random()),g=Z(q[d]);for(let t=0;t<f.data.length;t+=4)0==f[t]||s||(s=!0),118===f.data[t]&&(f.data[t]=g[0],f.data[t+1]=g[1],f.data[t+2]=g[2]),148==f.data[t]&&(f.data[t]=r[0],f.data[t+1]=r[1],f.data[t+2]=r[2]);l.putImageData(f,0,0),i[a]=w({image:h,frameWidth:16,frameHeight:32,animations:n})}),i})(t,e);const et=t=>{localStorage.setItem("nkholski",JSON.stringify(t))},it=(t,e)=>{const{font:i,gfx:n,context:s,customColors:o}=P();let a,r=!1,h=0,l=!1;s.save();const c=localStorage.getItem("nkholski")?JSON.parse(localStorage.getItem("nkholski")):(()=>{const t=new Array(99).fill(-1);return et(t),t})();t>-1&&c[t]<e&&(c[t]=e,et(c));let f=tt(n,o);J({spriteSheets:f});const g=c.indexOf(-1);let u=g<20?g:0;const p=g,m=U(t=>{for(let e=0;e<20;e++){t.beginPath();const s=e%5,o=(e-s)/5;e>g&&1==t.globalAlpha&&(t.globalAlpha=.5);for(let i=0;i<c[e];i++){const s=e%5,o=(e-s)/5;t.drawImage(n,96,16,8,8,45*s+16+19-8-6+10*i,45*o+12+3+18,16,16)}t.rect(45*s+16,45*o+12,40,40),v(i,e+1,-(45*s+16+19),45*o+12+3,2,null,null,t),t.stroke()}t.globalAlpha=1,t.fillStyle="rgba(99,99,99,0.5)";for(let e=0;e<3;e++)t.beginPath(),t.rect(75*e+16,192,70,40),t.fill(),v(i,["TITLE","HELP","CUSTOM"][e],-(75*e+16+37-4),205,1,null,null,t),t.stroke()}),y=d({update:()=>{if(!a){if(r)return;const t=j();if(!(l=l||!_(T.Any))||!_(T.Any))return;l=!1;let e=u;if(_(T.Up)&&(u-=5),_(T.Duck)&&(u+=5),_(T.Left)&&u--,_(T.Right)&&u++,e!==u&&B(1,.3,100,.4,.27,.1,2,2.9,.68),t[0]){const{x:e,y:i}=t[0];(u=Math.floor((e-16)/45)+5*Math.floor((i-12)/45))>19&&(console.log(e),u=e<88?20:e>160?22:21)}if(u=(u=u>22?22:u<0?0:u)<20&&u>p?p:u,console.log(u,p),_(T.Action)){if(r=!0,a=!0,u>19)return y.stop(),void(20===u?nt():21===u?(()=>{const{font:t}=P();let e=0,i=0,n="THIS IS THE UNTOLD STORY OF THE\nBACKSTABBER HERO. ZE IS TAKING\nCARE OF THE WORLDS BACKSTABBING\nCHORES NEGLIGATED BY MOST\nPEOPLE LIVING CAREFREE LIVES.\nACTING AS A SHADOW NO ONE HAS\nSEEN HIRS FACE///",s=n.length;const o=d({render:()=>{v(t,"BACK     ",-1,16,2,5,e),v(t,"    STORY",-1,16,2),v(t,n.substring(0,i),4,40,1),i>s&&(v(t,"INSTRUCTIONS",-1,120,2),v(t,"USE ARROW KEYS TO MOVE JUMP\nAND DUCK. PRESS Z TO STAB.\nSTUDY YOUR ENEMIES TO TIME\nYOUR ATTACKS. AN IMMOBILE\nBARREL GOES UNNOTICED/".substring(0,i-s),4,144,1)),e>999&&L(e/9)&&v(t,"PRESS Z TO CONTINUE",-1,220,1)},update:()=>{i=++e/3,(_(T.Any)||P().touches[0])&&e>99&&(o.stop(),nt())}});o.start()})():(()=>{let{font:t,spriteSheets:e,context:i,customColors:n,gfx:s}=P();const o=[];let a=document.monetization&&"started"===document.monetization.state,r=0,h=!1;i.fillStyle="#F00";let l=d({update:()=>{r++,i.closePath;let t=[...j()];if((h=h||!_(T.Any))&&0===t.length&&_(T.Any)&&(t[0]={x:0,y:121},console.log("ALIVE")),t[0]){let{x:i,y:h}=t[0];if(h>120&&r>99&&(l.stop(),nt()),a)for(let t=0;t<3;t++)for(let e=0;e<2;e++){let s=o[t]+(e>0?50:-12);i>s&&i<s+12&&h>60&&h<110&&(n[t]+=e>0?1:-1,n[t]=n[t]>255?255:n[t]<0?0:n[t])}e=tt(s,n),J({spriteSheets:e})}},render:()=>{v(t,"BACKSTABBER",-1,16,2),v(t,"CUSTOMIZATION",-1,32,2),L(r/9)&&r>99&&v(t,"PRESS T FOR TITLE",100,150,1),i.beginPath(),["RED","GREEN","BLUE"].forEach((e,s)=>{o[s]=13+90*s,i.rect(13+90*s,60,50,50),i.rect(1+90*s,84,8,2),i.rect(66+90*s,84,8,2),i.rect(66+90*s+3,81,2,8),v(t,e,-(36+90*s),69,1),v(t,Math.round(n[s]/255*100),-(36+90*s),82,2)}),i.stroke(),a||(i.beginPath(),i.rect(-9,70,265,11),i.fill(),v(t,"ONLY FOR COIL SUBSCRIBERS",-1,72,1),i.stroke()),i.drawImage(e[0].image,48,0,32,32,0,120,120,120)}});l.start()})());setTimeout(()=>{s.stroke(),s.restore(),X(u),y.stop()},1e3)}}},render:()=>{a?v(i,"LEVEL "+(u+1),-1,50,3):(s.drawImage(m,0,0),s.beginPath(),s.strokeStyle="#fff",s.fillStyle="rgba(255,255,255,0.3)",L(++h/9)&&(u<20?s.rect(u%5*45+16,45*Math.floor(u/5)+12,40,40):s.rect(u%5*75+16,192,70,40)),s.fill(),s.stroke())}});y.start()},nt=()=>{let t=0,e=100,i=0,n=-1,{context:s,spriteSheets:o,font:a}=P();s.imageSmoothingEnabled=!1;let r=d({update:()=>{e>0?e--:i<100&&i++,_(T.Any)&&t>99?(B(1,.1,568,.5,.9,1.5,0,4.5,.69),1==n&&(r.stop(),it(),n=2)):n=1},render:()=>{s.drawImage(o[0].image,48,0,32,32,0,120,120,120),v(a,"BACKSTABBER",-1,30,2,e,t++),s.globalAlpha=i/100,v(a,"HERO",-1,70-i/5,5.5),s.globalAlpha=.4*i/100,v(a,"HERO",-130,73-i/5,5),s.globalAlpha=1,100===i&&L(t/9)&&v(a,"PRESS Z TO STAB",-1,100,1),v(a,"-2019 NIKLAS BERG",110,225)}});r.start()},st=()=>{document.getElementById("c").style.setProperty("height",window.innerHeight+"px")},ot=()=>{let t=P().body.classList;t.add("mobile"),t.remove("por"),screen.width<screen.height&&t.add("por")};r(),(()=>{!function(){O={17:T.Stab,32:T.Space,37:T.Left,38:T.Up,39:T.Right,40:T.Duck,90:T.Stab},window.addEventListener("keydown",I),window.addEventListener("keyup",R),window.addEventListener("blur",C),[{i:"l",k:37},{i:"r",k:39},{i:"l2",k:37},{i:"r2",k:39},{i:"j",k:32},{i:"s",k:90},{i:"d",k:40}].forEach(t=>{const e=document.getElementById(t.i),i={which:t.k};e.ontouchstart=()=>I(i),e.ontouchend=()=>R(i)});let t=a().canvas;const e=e=>{M=[];const i=256/t.offsetWidth;for(let n=0;n<e.touches.length;n++)M[n]={x:(e.touches[n].clientX-t.offsetLeft)*i,y:e.touches[n].clientY*i};k[T.Any]=M.length>0,k[T.Action]=M.length>0};t.ontouchstart=e,t.ontouchend=e;const i=t=>{e({touches:"mouseup"===t.type?[]:[t]})};t.onmousedown=i,t.onmouseup=i}();window.zzfx_x=new AudioContext;const t={},e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA",i=[e+"TgAAAAHAQMAAACm6sPlAAAABlBMVEVHcEz///7ok5LVAAAAAXRSTlMAQObYZgAAAOJJREFUGBkFgKFqw0AYgA8CNxPK5C9C5HSZGBHHFfokBz9ETVSOcaTPUbk3+dWnQmSZKGVqMkyNiOMobihhqzUy9STIJZePCWCswUnXxsNu6s8xunfG2Swhfk7rL8AswDruji68dOr7tFdVB4aZIf471X8AE7jmsbu4oO1T+zYlr+ooRilLFf+XagWWLKx1CMOXE237fmymNh5cxTADYUvXO+W+eSHXLKeLE21Dc25UtHEwzmYjwi2xYPMNYVhX+Tnu3Wt7Uq8q6h0lbNUiU14myPa5ZMnPIDXspTuco49RYngAcXeJFg24RkQAAAAASUVORK5CYII=",e+"OAAAAAgCAMAAAA8G4RnAAAAGFBMVEVHcEyUlAOGAQAAAAB2CFQ0NTQAAQD///9c2OnGAAAAAXRSTlMAQObYZgAABJhJREFUWMOlmQuW2yAMRYGHyf53PAYJ0A8nPsO06UCM0dUPQVNKqcyW3rXTvFfvg2npczf5gO7Jie41RzmhJHLyHQS2876N/wh4I6WvgPth9ZIDIBSBk+8IgvLb+FG1vV3QP5ZvE4RaibrWpEKgLpOT7wcQ9ZUbx+eB0PBdzkUj+VGrHKDfa0UKTar9w8t3AkGkuD5cx2Kfz1r/80AYuKixWPTtB4Jw0KGKVfQEVseHHwgXi3zczBOABWUIUGsNCJtoKeW7XesjX7ED1t7WQL1h7i4PMF/9bAG1SY3GndwHkOQsxcMZKOh/S2FARdjK/LnK1QJAY7ElLCowBZrA64E5lAKTGo17D4tBmrcU8d1tECo3G4txDCiHv0xzFqMefyiJVIwJQGNS0nhZGndyxyAtm3kKsLdWhEaGfgoBtlLa1T9a6S56KSMmaY8NuPtJQBsLeuBODNI4/XhePzDX0PMUIEH2v5KQH7vRBmBHjAGrcklvQfJSH6Qqx2yTgm3Rl3S8wQAlCrbUmicBGVIn7huLetOCD4DKYjMCq8qsogd2Sjg+dlHyqTKTKgMtueFAWtsQfRgtGcvSS6XKC8CE2oJRDPYMOf5gAsgkutYQb8/aWyDjiVXeB/LmHQZrKVDACL+8PbG0AghEcAgCyFCVIxOWvj+UHYPBNjEtdtjoaXFkVNV3Wl7Tx/ddSbkuARePUYDkW5RjPu9sMstnBPVxmyn0KgfArCyGvRRkmI/HFg8EIT8cAAJ1vg/zfVYBqYoogwTsRVaTCld+8/NGv1yABFC6hAReBNkBjoH9NYlSa+4qmTJ3nhwoYPyTd65sLEwFSbwIrd+sWrVJC7oYtECs67wY9gPLxMSDFAJzwJI5pv9OoBoooCIp38zw5b4671gLjuijrTDKokNWkBqxDHr3JzCzCpfVFvTAO5hYVMrxg8gpIEHuBQc3fDrPEd4DYBaJeEec6BPbDqIYMJ8AZyXSXbRW972OgtgLHwEpgz4B7uDGEkh0NyqlUUpn1mLQISmdTUgfKGDuBAsypf9YMNgHOf63C4L6e9uepuNaUicVDipZFeQsN04LZBQgp9C01xacMXg+LvXoEAJRX3jsXHRaMI8H9rZpTGjOXwZIKMAqRdcTx5upQxYtx31Qe7/u+x2WMiDyPmqA89TphmMD4XDlEZ3Cj4SnS7cz4CpVlMaRrY/ulFB1TjFXGLYSCo+cwZ0OgAZVif4CqDd6H4MyC4jCSwfhKP0AdUTT55nolup0C3IAbBPy3XWqLdVMFhVEurjeOYesiQzEtXb2uSH0wGTvpbxGBuVLQF3JRIBcXOqQ1/uASnABoK2DI4DkvFZcV8xua2/5frCgE9n0oXNEgotJIOevFtSAakJbnon3gF9q0b2eOf9YJxyH402k+OZneLWf11lH3Rwu7XIA8mHx/xZ0WXRVW1Jo04eIMl+YccVzMODc8jZShiLsv7UUOceP/2fTvgHardpt3cok9uywbib241x5yX2EpWdku+1AXK69JGz7YrSF96L+qhmHjSq8xpYFmTCaraXVO/BM+Hab+L4PHnYpkybijKjB0x/gLyth3ZF8gQAAAABJRU5ErkJggg=="];["font","gfx"].forEach((e,n)=>{t[e]=new Image,t[e].src=i[n]}),t.gfx.onload=()=>{let e=[153,204,255],i=tt(t.gfx,e);const n=Object.assign({},t,{spriteSheets:i,touches:{},keys:{},customColors:e});J(n),P().mobile&&(window.onorientationchange=ot,window.onresize=st,ot()),nt()}})()}]);</script></body>